import{u as F,a as z,j as e}from"./index-FiQ-o0as.js";import{b as c,L as B}from"./vendor-DEA9Ikep.js";import{u as R,a as $}from"./usePresupuesto-Cs1wk0hO.js";import{u as P}from"./useDeuda-BGa7cw7X.js";import{u as T}from"./useFondosFederales-CqkNFsBn.js";import"./supabase-DANKYb0E.js";import"./export-t5FFX7R_.js";import"./presupuestoService-DLSKJf-Y.js";function S(s){return s==null||isNaN(s)?"$0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2,maximumFractionDigits:2}).format(s)}function I(s){return s?new Date(s).toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit"}):"--"}const _={danger:"bg-[#ff3e1d]",warning:"bg-[#ffab00]",info:"bg-[#03c3ec]",success:"bg-[#71dd37]"},C={aprobada:"bg-[#71dd37]/10 text-[#71dd37]",pendiente:"bg-[#ffab00]/10 text-[#ffab00]",borrador:"bg-[#8592a3]/10 text-[#8592a3]",cancelada:"bg-[#ff3e1d]/10 text-[#ff3e1d]"},O={aprobada:"Aprobada",pendiente:"Pendiente",borrador:"Borrador",cancelada:"Cancelada"},H=e.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"}),e.jsx("path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"}),e.jsx("path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z"})]}),W=e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})}),X=e.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),V=e.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"}),e.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]});function Z(s){return s?s.charAt(0).toUpperCase()+s.slice(1):""}function te(){const{entePublico:s,ejercicioFiscal:x}=F(),p=x?.anio||new Date().getFullYear(),{data:a,isLoading:b}=R(),{data:o,isLoading:j}=$(),{data:f,isLoading:N}=P(),{data:n,isLoading:v}=z(),{data:d}=T(),y=b||j||N,l=a?.aprobado||0,m=a?.ejercido||0,u=o?.recaudado||0,h=o?.estimado||0,w=f?.saldo_total||0,k=l>0?(m/l*100).toFixed(1):"0.0",L=h>0?(u/h*100).toFixed(1):"0.0",E=[{label:"Presupuesto Aprobado",subtitle:"Monto total autorizado",value:l,icon:H,iconBg:"bg-guinda/10",iconText:"text-guinda"},{label:"Presupuesto Ejercido",subtitle:`${k}% del aprobado`,value:m,icon:W,iconBg:"bg-verde/10",iconText:"text-verde"},{label:"Ingresos Recaudados",subtitle:`${L}% de la estimacion`,value:u,icon:X,iconBg:"bg-dorado/10",iconText:"text-dorado"},{label:"Deuda Publica",subtitle:"Saldo vigente",value:w,icon:V,iconBg:"bg-[#ff3e1d]/10",iconText:"text-[#ff3e1d]"}],g=c.useMemo(()=>n?.slice(0,5)||[],[n]),D=c.useMemo(()=>{const t=[],i=n?.filter(A=>A.estado==="pendiente")?.length||0;i>0&&t.push({level:"info",text:`${i} poliza${i>1?"s":""} pendiente${i>1?"s":""} de aprobacion`});const r=a?.aprobado>0?a.ejercido/a.aprobado*100:0;return r>0&&r<10&&t.push({level:"warning",text:"Ejecucion presupuestal por debajo del 10%"}),!a?.aprobado&&!o?.estimado&&t.push({level:"warning",text:"Sin datos presupuestales registrados"}),t.length===0&&t.push({level:"success",text:"Sistema operando sin alertas"}),t},[n,a,o]),M=c.useMemo(()=>{const t=a?.aprobado>0?a.ejercido/a.aprobado*100:0,i=o?.estimado>0?o.recaudado/o.estimado*100:0,r=d?.total_asignado>0?d.total_ejercido/d.total_asignado*100:0;return[{label:"Ejecucion presupuestal",value:Math.min(t,100)},{label:"Recaudacion de ingresos",value:Math.min(i,100)},{label:"Avance fondos federales",value:Math.min(r,100)}]},[a,o,d]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-text-heading",children:"Dashboard"}),e.jsxs("p",{className:"text-[0.9375rem] text-text-muted mt-1",children:[s?.nombre||"Ente Publico"," â€” Ejercicio ",p]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:E.map(t=>e.jsxs("div",{className:"bg-white border-0 rounded-lg card-shadow p-6 flex items-start justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[13px] font-medium text-text-muted mb-1",children:t.label}),e.jsx("p",{className:`text-[22px] font-bold text-text-heading leading-tight tracking-tight ${y?"animate-pulse":""}`,children:S(t.value)}),e.jsx("p",{className:"text-xs text-text-muted mt-1.5",children:t.subtitle})]}),e.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center ${t.iconBg} ${t.iconText}`,children:t.icon})]},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white border-0 rounded-lg card-shadow",children:[e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between border-b border-border",children:[e.jsx("h2",{className:"text-[15px] font-semibold text-text-heading",children:"Polizas Recientes"}),e.jsx(B,{to:"/contabilidad/polizas",className:"text-[13px] text-guinda font-medium hover:text-guinda-dark transition-colors",children:"Ver todas"})]}),e.jsx("div",{className:"overflow-x-auto",children:v?e.jsx("p",{className:"px-6 py-8 text-center text-[13px] text-text-muted",children:"Cargando..."}):g.length===0?e.jsx("p",{className:"px-6 py-8 text-center text-[13px] text-text-muted",children:"No hay polizas registradas"}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#f9fafb]",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Folio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Monto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Estado"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{className:"border-b border-border/50 last:border-0 hover:bg-bg-hover transition-colors",children:[e.jsxs("td",{className:"px-6 py-3.5 font-mono text-[13px] text-guinda font-semibold",children:["POL-",p,"-",String(t.numero_poliza).padStart(4,"0")]}),e.jsx("td",{className:"px-6 py-3.5 text-[14px] text-text-primary",children:Z(t.tipo)}),e.jsx("td",{className:"px-6 py-3.5 text-[13px] text-text-muted",children:I(t.fecha)}),e.jsx("td",{className:"px-6 py-3.5 text-right font-mono text-[14px] font-semibold text-text-heading",children:"--"}),e.jsx("td",{className:"px-6 py-3.5",children:e.jsx("span",{className:`inline-block text-xs font-medium px-2.5 py-1 rounded-full capitalize ${C[t.estado]||""}`,children:O[t.estado]||t.estado})})]},t.id))})]})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white border-0 rounded-lg card-shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border",children:e.jsx("h2",{className:"text-[15px] font-semibold text-text-heading",children:"Alertas"})}),e.jsx("div",{className:"p-5 space-y-4",children:D.map((t,i)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-[7px] flex-shrink-0 ${_[t.level]}`}),e.jsx("p",{className:"text-[13px] text-text-primary leading-relaxed",children:t.text})]},i))})]}),e.jsxs("div",{className:"bg-white border-0 rounded-lg card-shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-border",children:e.jsx("h2",{className:"text-[15px] font-semibold text-text-heading",children:"Avance del Ejercicio"})}),e.jsx("div",{className:"p-6 space-y-5",children:M.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[13px] text-text-primary",children:t.label}),e.jsxs("span",{className:"text-[13px] font-bold text-text-heading",children:[t.value.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-bg-main rounded-full h-[6px]",children:e.jsx("div",{className:"bg-guinda h-[6px] rounded-full transition-all duration-500",style:{width:`${t.value}%`}})})]},t.label))})]})]})]})]})}export{te as default};
