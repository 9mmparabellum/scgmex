import{u as N,m as _,j as e}from"./index-CHHoMz4Q.js";import{b as d}from"./vendor-DEA9Ikep.js";import{u as p,B as h}from"./Button-BlJJN9v_.js";import{S as v}from"./Select-Dfn36s6t.js";import{e as k}from"./exportHelpers-CvXmrB4L.js";import{e as w}from"./exportPdfHelpers-A3uAR0yr.js";import"./export-t5FFX7R_.js";import"./supabase-DANKYb0E.js";const s=i=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(i||0);function F(){const{entePublico:i,ejercicioFiscal:b}=N(),[n,u]=d.useState(""),{data:c=[]}=p("periodo_contable",{filter:{ejercicio_id:b?.id},order:{column:"numero",ascending:!0}}),f=d.useMemo(()=>c.map(t=>({value:t.id,label:t.nombre||`Periodo ${t.numero}`})),[c]),{data:x=[],isLoading:g}=_(n),{data:m=[]}=p("plan_de_cuentas",{filter:{ente_id:i?.id},order:{column:"codigo",ascending:!0}}),o=d.useMemo(()=>{const t={};return m.forEach(a=>{t[a.id]=a}),x.map(a=>{const l=t[a.cuenta_id]||{};return{...a,codigo:l.codigo||"",nombre:l.nombre||"",naturaleza:l.naturaleza||"deudora",tipo_cuenta:l.tipo_cuenta||""}}).sort((a,l)=>a.codigo.localeCompare(l.codigo))},[x,m]),r=d.useMemo(()=>o.reduce((t,a)=>({saldo_inicial:t.saldo_inicial+(a.saldo_inicial||0),total_debe:t.total_debe+(a.total_debe||0),total_haber:t.total_haber+(a.total_haber||0),saldo_final:t.saldo_final+(a.saldo_final||0)}),{saldo_inicial:0,total_debe:0,total_haber:0,saldo_final:0}),[o]),j=()=>{k(o,[{key:"codigo",label:"Codigo"},{key:"nombre",label:"Nombre"},{key:"saldo_inicial",label:"Saldo Inicial"},{key:"total_debe",label:"Debe"},{key:"total_haber",label:"Haber"},{key:"saldo_final",label:"Saldo Final"}],"balanza_comprobacion")},y=()=>{w(o,[{key:"codigo",label:"Codigo"},{key:"nombre",label:"Nombre"},{key:"saldo_inicial",label:"Saldo Inicial"},{key:"total_debe",label:"Debe"},{key:"total_haber",label:"Haber"},{key:"saldo_final",label:"Saldo Final"}],"balanza_comprobacion",{title:"Balanza de Comprobacion"})};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Balanza de Comprobacion"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"Art. 37 â€” Saldos por cuenta contable en el periodo"})]}),e.jsx("div",{className:"bg-white rounded-lg card-shadow p-4 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsx(v,{label:"Periodo",placeholder:"Seleccionar periodo...",options:f,value:n,onChange:t=>u(t.target.value)}),e.jsx("div",{}),e.jsxs("div",{className:"flex justify-end",children:[e.jsxs(h,{variant:"ghost",onClick:j,disabled:!o?.length,children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Exportar XLSX"]}),e.jsxs(h,{variant:"ghost",onClick:y,disabled:!o?.length,children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Exportar PDF"]})]})]})}),g?e.jsx("div",{className:"bg-white rounded-lg card-shadow p-5",children:e.jsx("div",{className:"text-center py-16 text-text-muted text-sm",children:"Cargando balanza..."})}):n?o.length===0?e.jsx("div",{className:"bg-white rounded-lg card-shadow p-5",children:e.jsx("div",{className:"text-center py-16 text-text-muted text-sm",children:"No hay saldos registrados para este periodo"})}):e.jsx("div",{className:"bg-white rounded-lg card-shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#f9fafb]",children:[e.jsx("th",{className:"text-left text-xs font-semibold text-text-secondary uppercase tracking-wider px-5 py-3.5",children:"Codigo"}),e.jsx("th",{className:"text-left text-xs font-semibold text-text-secondary uppercase tracking-wider px-5 py-3.5",children:"Nombre"}),e.jsx("th",{className:"text-right text-xs font-semibold text-text-secondary uppercase tracking-wider px-5 py-3.5",children:"Saldo Inicial"}),e.jsx("th",{className:"text-right text-xs font-semibold text-text-secondary uppercase tracking-wider px-5 py-3.5",children:"Debe"}),e.jsx("th",{className:"text-right text-xs font-semibold text-text-secondary uppercase tracking-wider px-5 py-3.5",children:"Haber"}),e.jsx("th",{className:"text-right text-xs font-semibold text-text-secondary uppercase tracking-wider px-5 py-3.5",children:"Saldo Final"})]})}),e.jsx("tbody",{children:o.map((t,a)=>e.jsxs("tr",{className:"border-b border-[#f0f0f0] hover:bg-[#f9fafb]",children:[e.jsx("td",{className:"px-5 py-3 font-mono text-sm",children:t.codigo}),e.jsx("td",{className:"px-5 py-3 text-sm",children:t.nombre}),e.jsx("td",{className:"px-5 py-3 text-sm text-right font-mono",children:s(t.saldo_inicial)}),e.jsx("td",{className:"px-5 py-3 text-sm text-right font-mono",children:s(t.total_debe)}),e.jsx("td",{className:"px-5 py-3 text-sm text-right font-mono",children:s(t.total_haber)}),e.jsx("td",{className:"px-5 py-3 text-sm text-right font-mono font-semibold",children:s(t.saldo_final)})]},a))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-[#f9fafb] font-bold border-t-2 border-guinda/20",children:[e.jsx("td",{colSpan:2,className:"px-5 py-3.5 text-sm text-right",children:"TOTALES"}),e.jsx("td",{className:"px-5 py-3.5 text-sm text-right font-mono",children:s(r.saldo_inicial)}),e.jsx("td",{className:"px-5 py-3.5 text-sm text-right font-mono",children:s(r.total_debe)}),e.jsx("td",{className:"px-5 py-3.5 text-sm text-right font-mono",children:s(r.total_haber)}),e.jsx("td",{className:"px-5 py-3.5 text-sm text-right font-mono",children:s(r.saldo_final)})]})})]})})}):e.jsx("div",{className:"bg-white rounded-lg card-shadow p-5",children:e.jsx("div",{className:"text-center py-16 text-text-muted text-sm",children:"Seleccione un periodo para ver la balanza"})})]})}export{F as default};
