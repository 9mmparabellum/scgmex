import{s as o,u as c,o as s}from"./index-CyKkzz21.js";async function u(e){const{data:t,error:a}=await o.from("certificado_efirma").select("*").eq("ente_id",e).order("fecha_vigencia_fin",{ascending:!1});if(a)throw a;return t}async function m(e,t){const{data:a,error:n}=await o.from("documento_firmado").select("*, certificado:certificado_efirma!certificado_id(numero_serie, titular)").eq("ente_id",e).eq("ejercicio_id",t).order("fecha_firma",{ascending:!1});if(n)throw n;return a}async function l(e){const[t,a]=await Promise.all([o.from("certificado_efirma").select("id, tipo, estado, fecha_vigencia_fin").eq("ente_id",e),o.from("documento_firmado").select("id, estado").eq("ente_id",e)]),n=t.data||[],r=a.data||[],d=new Date,f=720*60*60*1e3;return{totalCertificados:n.length,vigentes:n.filter(i=>i.estado==="vigente").length,porVencer:n.filter(i=>i.estado==="vigente"&&new Date(i.fecha_vigencia_fin)<new Date(d.getTime()+f)).length,totalDocumentos:r.length,firmados:r.filter(i=>i.estado==="firmado").length,pendientes:r.filter(i=>i.estado==="pendiente").length}}function h(){const{entePublico:e}=c();return s({queryKey:["certificado_efirma",e?.id],queryFn:()=>u(e.id),enabled:!!e?.id})}function g(){const{entePublico:e,ejercicioFiscal:t}=c();return s({queryKey:["documento_firmado",e?.id,t?.id],queryFn:()=>m(e.id,t.id),enabled:!!e?.id&&!!t?.id})}function y(){const{entePublico:e}=c();return s({queryKey:["resumen_efirma",e?.id],queryFn:()=>l(e.id),enabled:!!e?.id})}export{y as a,g as b,h as u};
