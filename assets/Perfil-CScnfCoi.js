import{u as m,j as e,s as N}from"./index-DlnbnB4f.js";import{b as s}from"./vendor-DEA9Ikep.js";import"./supabase-DANKYb0E.js";import"./export-t5FFX7R_.js";function U(){const r=m(t=>t.user),v=m(t=>t.setUser),w=m(t=>t.rol),[l,x]=s.useState(r?.nombre||""),[u,b]=s.useState(!1),[C,o]=s.useState(null),[c,i]=s.useState(""),[p,d]=s.useState(""),[h,g]=s.useState(!1),[S,a]=s.useState(null),P=async()=>{if(o(null),!l.trim()){o({type:"error",text:"El nombre no puede estar vacio."});return}b(!0);try{const{error:t}=await N.from("usuarios").update({nombre:l.trim()}).eq("id",r.id);if(t)throw t;v({...r,nombre:l.trim()}),o({type:"success",text:"Nombre actualizado correctamente."})}catch(t){o({type:"error",text:t.message||"Error al actualizar el nombre."})}finally{b(!1)}},k=async()=>{if(a(null),c.length<8){a({type:"error",text:"La contrasena debe tener al menos 8 caracteres."});return}if(c!==p){a({type:"error",text:"Las contrasenas no coinciden."});return}g(!0);try{const{error:t}=await N.auth.updateUser({password:c});if(t)throw t;i(""),d(""),a({type:"success",text:"Contrasena actualizada correctamente."})}catch(t){a({type:"error",text:t.message||"Error al cambiar la contrasena."})}finally{g(!1)}},y=({msg:t})=>{if(!t)return null;const M=t.type==="success";return e.jsx("div",{className:`mt-3 rounded-md border px-4 py-3 text-sm ${M?"border-green-300 bg-green-50 text-green-800":"border-red-300 bg-red-50 text-red-800"}`,children:t.text})},n="w-full h-[40px] rounded-md border border-border px-3 text-[0.9375rem] focus:outline-none focus:border-guinda focus:ring-1 focus:ring-guinda/30",f="h-[38px] rounded-md bg-guinda text-white hover:bg-guinda-dark px-5 text-sm font-medium transition-colors disabled:opacity-50",j="h-[38px] rounded-md border border-border text-text-secondary hover:bg-bg-hover px-5 text-sm font-medium transition-colors";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:"Mi Perfil"}),e.jsx("p",{className:"mt-1 text-sm text-text-secondary",children:"Informacion personal y seguridad"})]}),e.jsxs("div",{className:"bg-white rounded-lg card-shadow p-5",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"Datos Personales"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Nombre"}),e.jsx("input",{type:"text",className:n,value:l,onChange:t=>x(t.target.value),placeholder:"Tu nombre completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Correo electronico"}),e.jsx("input",{type:"email",className:`${n} bg-gray-50 text-text-secondary cursor-not-allowed`,value:r?.email||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Rol"}),e.jsx("input",{type:"text",className:`${n} bg-gray-50 text-text-secondary cursor-not-allowed`,value:w||r?.rol||"Sin rol asignado",readOnly:!0})]})]}),e.jsx(y,{msg:C}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx("button",{className:f,onClick:P,disabled:u,children:u?"Guardando...":"Guardar cambios"}),e.jsx("button",{className:j,onClick:()=>{x(r?.nombre||""),o(null)},children:"Cancelar"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg card-shadow p-5",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"Cambiar Contrasena"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Nueva contrasena"}),e.jsx("input",{type:"password",className:n,value:c,onChange:t=>i(t.target.value),placeholder:"Minimo 8 caracteres"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Confirmar contrasena"}),e.jsx("input",{type:"password",className:n,value:p,onChange:t=>d(t.target.value),placeholder:"Repite la contrasena"})]})]}),e.jsx(y,{msg:S}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx("button",{className:f,onClick:k,disabled:h,children:h?"Actualizando...":"Actualizar contrasena"}),e.jsx("button",{className:j,onClick:()=>{i(""),d(""),a(null)},children:"Cancelar"})]})]})]})}export{U as default};
