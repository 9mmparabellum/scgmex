import{s as n,u as t,o as c}from"./index-w8y8owqO.js";async function q(e){const{data:o,error:i}=await n.from("proveedor").select("*").eq("ente_id",e).order("razon_social");if(i)throw i;return o}async function m(e,o){const{data:i,error:r}=await n.from("requisicion").select("*, solicitante:usuarios!solicitado_por(nombre), autorizador:usuarios!autorizado_por(nombre)").eq("ente_id",e).eq("ejercicio_id",o).order("numero",{ascending:!1});if(r)throw r;return i}async function f(e,o){const{data:i,error:r}=await n.from("orden_compra").select("*, proveedor:proveedor!proveedor_id(razon_social, rfc), requisicion:requisicion!requisicion_id(numero)").eq("ente_id",e).eq("ejercicio_id",o).order("numero",{ascending:!1});if(r)throw r;return i}async function _(e,o){const[i,r,l]=await Promise.all([n.from("proveedor").select("id",{count:"exact"}).eq("ente_id",e).eq("activo",!0),n.from("requisicion").select("id, monto_estimado, estado").eq("ente_id",e).eq("ejercicio_id",o),n.from("orden_compra").select("id, total, estado").eq("ente_id",e).eq("ejercicio_id",o)]),d=r.data||[],u=l.data||[];return{totalProveedores:i.count||0,totalRequisiciones:d.length,montoRequisiciones:d.reduce((s,a)=>s+Number(a.monto_estimado||0),0),totalOrdenes:u.length,montoOrdenes:u.filter(s=>s.estado!=="cancelada").reduce((s,a)=>s+Number(a.total||0),0)}}function y(){const{entePublico:e}=t();return c({queryKey:["proveedores",e?.id],queryFn:()=>q(e.id),enabled:!!e?.id})}function b(){const{entePublico:e,ejercicioFiscal:o}=t();return c({queryKey:["requisiciones",e?.id,o?.id],queryFn:()=>m(e.id,o.id),enabled:!!e?.id&&!!o?.id})}function v(){const{entePublico:e,ejercicioFiscal:o}=t();return c({queryKey:["ordenes_compra",e?.id,o?.id],queryFn:()=>f(e.id,o.id),enabled:!!e?.id&&!!o?.id})}function h(){const{entePublico:e,ejercicioFiscal:o}=t();return c({queryKey:["resumen_adquisiciones",e?.id,o?.id],queryFn:()=>_(e.id,o.id),enabled:!!e?.id&&!!o?.id})}export{y as a,b,v as c,h as u};
