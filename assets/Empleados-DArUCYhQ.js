import{u as V,j as a}from"./index-KskWbqO9.js";import{b as r}from"./vendor-DEA9Ikep.js";import{useCreate as $,useUpdate as G,useRemove as H}from"./useCrud-C19KmPO4.js";import{a as J}from"./useNomina-BqIh5j4D.js";import{s as E,t as x}from"./constants-CX_We7cr.js";import{D as K}from"./DataTable-DWljaDCm.js";import{M as Q}from"./Modal-DfjuYvxB.js";import{B as m}from"./Button-DGu3eAys.js";import{I as s}from"./Input-CHoXOb6x.js";import{S as k}from"./Select-k3R1vLiz.js";import{B as h}from"./Badge-B4UqNpVe.js";import{C as W}from"./ConfirmDialog-D5TWhe0q.js";import{e as X}from"./exportHelpers-CvXmrB4L.js";import"./supabase-DANKYb0E.js";import"./export-t5FFX7R_.js";const S={numero_empleado:"",nombre:"",rfc:"",curp:"",nss:"",fecha_ingreso:"",puesto:"",area:"",nivel_tabulador:"",tipo_contrato:"base",estado:"activo",cuenta_bancaria:"",banco:""};function pe(){const{entePublico:P}=V(),[A,n]=r.useState(!1),[c,v]=r.useState(null),[o,p]=r.useState({...S}),[O,u]=r.useState(!1),[i,b]=r.useState(null),{data:g=[],isLoading:T}=J(),f=$("empleado"),j=G("empleado"),C=H("empleado"),M=r.useMemo(()=>Object.entries(E).map(([e,t])=>({value:e,label:t})),[]),B=r.useMemo(()=>Object.entries(x).map(([e,{label:t}])=>({value:e,label:t})),[]),l=(e,t)=>p(d=>({...d,[e]:t})),D=e=>{const t=x[e];return t?a.jsx(h,{variant:t.variant,children:t.label}):a.jsx(h,{variant:"default",children:e})},y=e=>E[e]||e,R=e=>({base:"primary",confianza:"info",eventual:"warning",honorarios:"default"})[e]||"default",F=()=>{v(null),p({...S}),n(!0)},_=e=>{v(e),p({numero_empleado:e.numero_empleado??"",nombre:e.nombre??"",rfc:e.rfc??"",curp:e.curp??"",nss:e.nss??"",fecha_ingreso:e.fecha_ingreso??"",puesto:e.puesto??"",area:e.area??"",nivel_tabulador:e.nivel_tabulador??"",tipo_contrato:e.tipo_contrato??"base",estado:e.estado??"activo",cuenta_bancaria:e.cuenta_bancaria??"",banco:e.banco??""}),n(!0)},I=async()=>{const e={...o,ente_id:P?.id};c?await j.mutateAsync({id:c.id,...e}):await f.mutateAsync(e),n(!1)},q=e=>{b(e),u(!0)},z=async()=>{i&&await C.mutateAsync(i.id),u(!1),b(null)},L=()=>{X(g,[{key:"numero_empleado",label:"No. Empleado"},{key:"nombre",label:"Nombre"},{key:"rfc",label:"RFC"},{key:"curp",label:"CURP"},{key:"nss",label:"NSS"},{key:"fecha_ingreso",label:"Fecha Ingreso"},{key:"puesto",label:"Puesto"},{key:"area",label:"Area"},{key:"nivel_tabulador",label:"Nivel Tabulador"},{key:"tipo_contrato",label:"Tipo Contrato",getValue:t=>y(t.tipo_contrato)},{key:"estado",label:"Estado",getValue:t=>x[t.estado]?.label||t.estado},{key:"cuenta_bancaria",label:"Cuenta Bancaria"},{key:"banco",label:"Banco"}],"empleados")},U=r.useMemo(()=>[{key:"numero_empleado",label:"No. Empleado",width:"120px"},{key:"nombre",label:"Nombre"},{key:"rfc",label:"RFC",width:"140px"},{key:"puesto",label:"Puesto",width:"150px"},{key:"area",label:"Area",width:"130px"},{key:"tipo_contrato",label:"Tipo Contrato",width:"130px",render:e=>a.jsx(h,{variant:R(e),children:y(e)})},{key:"estado",label:"Estado",width:"110px",render:e=>D(e)},{key:"id",label:"Acciones",width:"140px",sortable:!1,render:(e,t)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:d=>{d.stopPropagation(),_(t)},className:"text-xs text-primary hover:text-primary-light transition-colors cursor-pointer",children:"Editar"}),a.jsx("button",{onClick:d=>{d.stopPropagation(),q(t)},className:"text-xs text-danger hover:text-danger/80 transition-colors cursor-pointer",children:"Eliminar"})]})}],[]),N=f.isPending||j.isPending;return a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Empleados"}),a.jsx("p",{className:"text-sm text-text-muted mt-1",children:"Administracion del padron de empleados del ente publico"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-sm font-semibold text-text-secondary",children:["Empleados",a.jsxs("span",{className:"ml-2 text-text-muted font-normal",children:["(",g.length," registros)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(m,{onClick:L,variant:"outline-primary",size:"sm",children:"Exportar Excel"}),a.jsx(m,{onClick:F,size:"sm",children:"+ Nuevo Empleado"})]})]}),T?a.jsx("div",{className:"flex items-center justify-center py-16 text-text-muted text-sm",children:"Cargando empleados..."}):a.jsx(K,{columns:U,data:g,onRowClick:_}),a.jsx(Q,{open:A,onClose:()=>n(!1),title:c?"Editar Empleado":"Nuevo Empleado",size:"lg",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(s,{label:"Numero de Empleado",value:o.numero_empleado,onChange:e=>l("numero_empleado",e.target.value),placeholder:"Ej. EMP-001",required:!0}),a.jsx(s,{label:"Nombre Completo",value:o.nombre,onChange:e=>l("nombre",e.target.value),placeholder:"Nombre completo del empleado",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(s,{label:"RFC",value:o.rfc,onChange:e=>l("rfc",e.target.value),placeholder:"13 caracteres"}),a.jsx(s,{label:"CURP",value:o.curp,onChange:e=>l("curp",e.target.value),placeholder:"18 caracteres"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(s,{label:"NSS",value:o.nss,onChange:e=>l("nss",e.target.value),placeholder:"Numero de Seguridad Social"}),a.jsx(s,{label:"Fecha de Ingreso",type:"date",value:o.fecha_ingreso,onChange:e=>l("fecha_ingreso",e.target.value)})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(s,{label:"Puesto",value:o.puesto,onChange:e=>l("puesto",e.target.value),placeholder:"Puesto del empleado"}),a.jsx(s,{label:"Area",value:o.area,onChange:e=>l("area",e.target.value),placeholder:"Area o departamento"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(s,{label:"Nivel Tabulador",value:o.nivel_tabulador,onChange:e=>l("nivel_tabulador",e.target.value),placeholder:"Nivel en el tabulador"}),a.jsx(k,{label:"Tipo de Contrato",value:o.tipo_contrato,onChange:e=>l("tipo_contrato",e.target.value),options:M,placeholder:"-- Seleccione tipo --",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(k,{label:"Estado",value:o.estado,onChange:e=>l("estado",e.target.value),options:B,placeholder:"-- Seleccione estado --",required:!0}),a.jsx(s,{label:"Cuenta Bancaria",value:o.cuenta_bancaria,onChange:e=>l("cuenta_bancaria",e.target.value),placeholder:"Numero de cuenta"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.jsx(s,{label:"Banco",value:o.banco,onChange:e=>l("banco",e.target.value),placeholder:"Nombre del banco"})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t border-border",children:[a.jsx(m,{variant:"ghost",onClick:()=>n(!1),disabled:N,children:"Cancelar"}),a.jsx(m,{onClick:I,loading:N,disabled:!o.numero_empleado.trim()||!o.nombre.trim(),children:c?"Guardar cambios":"Crear empleado"})]})]})}),a.jsx(W,{open:O,onClose:()=>{u(!1),b(null)},onConfirm:z,title:"Eliminar empleado",message:i?`¿Esta seguro de eliminar al empleado "${i.numero_empleado} — ${i.nombre}"? Esta accion no se puede deshacer.`:"",confirmText:"Eliminar",loading:C.isPending})]})}export{pe as default};
