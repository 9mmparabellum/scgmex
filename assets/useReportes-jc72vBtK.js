import{s as d,u as _,o as f}from"./index-hqQh5qHZ.js";const m=["activo"],h=["pasivo"],p=["hacienda","hacienda_publica"],g=["ingresos"],y=["gastos"];function b(o){const n={};for(const t of o)n[t.cuenta_id]=t;return n}function l(o,n,t){const a=o.filter(i=>t.includes(i.tipo_cuenta));let e=0;return{cuentas:a.map(i=>{const c=n[i.id]||{},r=Number(c.saldo_final)||0;return e+=r,{...i,saldo_final:r}}),total:e}}function E(o,n){return o.map(t=>{const a=n[t.id]||{};return{codigo:t.codigo,nombre:t.nombre,nivel:t.nivel,saldo_inicial:Number(a.saldo_inicial)||0,total_debe:Number(a.total_debe)||0,total_haber:Number(a.total_haber)||0,saldo_final:Number(a.saldo_final)||0}})}async function q(o,n,t){const{data:a,error:e}=await d.from("plan_de_cuentas").select("id, codigo, nombre, tipo_cuenta, naturaleza, nivel").eq("ente_id",o);if(e)throw e;const{data:s,error:i}=await d.from("saldo_cuenta").select("cuenta_id, saldo_final").eq("periodo_id",t);if(i)throw i;const c=b(s);return{activo:l(a,c,m),pasivo:l(a,c,h),hacienda:l(a,c,p)}}async function v(o,n,t){const{data:a,error:e}=await d.from("plan_de_cuentas").select("id, codigo, nombre, tipo_cuenta, naturaleza, nivel").eq("ente_id",o);if(e)throw e;const{data:s,error:i}=await d.from("saldo_cuenta").select("cuenta_id, saldo_final").eq("periodo_id",t);if(i)throw i;const c=b(s),r=l(a,c,g),u=l(a,c,y);return{ingresos:r,gastos:u,resultado:r.total-u.total}}async function w(o,n,t){const{data:a,error:e}=await d.from("plan_de_cuentas").select("id, codigo, nombre, tipo_cuenta, naturaleza, nivel").eq("ente_id",o).in("tipo_cuenta",p);if(e)throw e;const s=a.map(u=>u.id),{data:i,error:c}=await d.from("saldo_cuenta").select("cuenta_id, saldo_final").eq("periodo_id",t).in("cuenta_id",s);if(c)throw c;const r=b(i);return I(a,r)}function I(o,n){const t={contribuida:{cuentas:[],total:0},generada:{cuentas:[],total:0},exceso:{cuentas:[],total:0}};for(const a of o){const e=n[a.id]||{},s=Number(e.saldo_final)||0,i={...a,saldo_final:s};a.codigo.startsWith("3.1")?(t.contribuida.cuentas.push(i),t.contribuida.total+=s):a.codigo.startsWith("3.2")?(t.generada.cuentas.push(i),t.generada.total+=s):a.codigo.startsWith("3.3")&&(t.exceso.cuentas.push(i),t.exceso.total+=s)}return t}async function S(o,n,t){const{data:a,error:e}=await d.from("plan_de_cuentas").select("id, codigo, nombre, tipo_cuenta, naturaleza, nivel").eq("ente_id",o).eq("tipo_cuenta","activo");if(e)throw e;const s=a.map(u=>u.id),{data:i,error:c}=await d.from("saldo_cuenta").select("cuenta_id, saldo_inicial, total_debe, total_haber, saldo_final").eq("periodo_id",t).in("cuenta_id",s);if(c)throw c;const r=b(i);return E(a,r)}function j(o){const{entePublico:n,ejercicioFiscal:t}=_(),a=n?.id,e=t?.id;return f({queryKey:["estado_situacion",a,e,o],queryFn:()=>q(a,e,o),enabled:!!a&&!!e&&!!o})}function A(o){const{entePublico:n,ejercicioFiscal:t}=_(),a=n?.id,e=t?.id;return f({queryKey:["estado_actividades",a,e,o],queryFn:()=>v(a,e,o),enabled:!!a&&!!e&&!!o})}function P(o){const{entePublico:n,ejercicioFiscal:t}=_(),a=n?.id,e=t?.id;return f({queryKey:["estado_variacion",a,e,o],queryFn:()=>w(a,e,o),enabled:!!a&&!!e&&!!o})}function O(o){const{entePublico:n,ejercicioFiscal:t}=_(),a=n?.id,e=t?.id;return f({queryKey:["estado_analitico",a,e,o],queryFn:()=>S(a,e,o),enabled:!!a&&!!e&&!!o})}export{A as a,P as b,O as c,j as u};
