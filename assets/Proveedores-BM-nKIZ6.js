import{u as M,j as a}from"./index-KskWbqO9.js";import{b as i}from"./vendor-DEA9Ikep.js";import{useCreate as T,useUpdate as I,useRemove as F}from"./useCrud-C19KmPO4.js";import{a as G}from"./useAdquisiciones-jv4_zgRV.js";import{D as O}from"./DataTable-DWljaDCm.js";import{M as q}from"./Modal-DfjuYvxB.js";import{B as m}from"./Button-DGu3eAys.js";import{I as t}from"./Input-CHoXOb6x.js";import{S as L}from"./Select-k3R1vLiz.js";import{B as X}from"./Badge-B4UqNpVe.js";import{C as U}from"./ConfirmDialog-D5TWhe0q.js";import{e as V}from"./exportHelpers-CvXmrB4L.js";import"./supabase-DANKYb0E.js";import"./export-t5FFX7R_.js";const y={rfc:"",razon_social:"",nombre_comercial:"",domicilio:"",telefono:"",email:"",contacto:"",giro:"",cuenta_bancaria:"",clabe:"",banco:"",activo:!0};function re(){const{entePublico:k}=M(),[N,s]=i.useState(!1),[n,b]=i.useState(null),[o,u]=i.useState({...y}),[E,p]=i.useState(!1),[d,v]=i.useState(null),{data:x=[],isLoading:_}=G(),g=T("proveedor"),h=I("proveedor"),f=F("proveedor"),z=[{value:"true",label:"Activo"},{value:"false",label:"Inactivo"}],l=(e,r)=>u(c=>({...c,[e]:r})),S=()=>{b(null),u({...y}),s(!0)},j=e=>{b(e),u({rfc:e.rfc??"",razon_social:e.razon_social??"",nombre_comercial:e.nombre_comercial??"",domicilio:e.domicilio??"",telefono:e.telefono??"",email:e.email??"",contacto:e.contacto??"",giro:e.giro??"",cuenta_bancaria:e.cuenta_bancaria??"",clabe:e.clabe??"",banco:e.banco??"",activo:e.activo??!0}),s(!0)},P=async()=>{const e={...o,ente_id:k?.id,activo:o.activo===!0||o.activo==="true"};n?await h.mutateAsync({id:n.id,...e}):await g.mutateAsync(e),s(!1)},A=e=>{v(e),p(!0)},B=async()=>{d&&await f.mutateAsync(d.id),p(!1),v(null)},R=()=>{V(x,[{key:"rfc",label:"RFC"},{key:"razon_social",label:"Razon Social"},{key:"nombre_comercial",label:"Nombre Comercial"},{key:"telefono",label:"Telefono"},{key:"email",label:"Email"},{key:"contacto",label:"Contacto"},{key:"giro",label:"Giro"},{key:"cuenta_bancaria",label:"Cuenta Bancaria"},{key:"clabe",label:"CLABE"},{key:"banco",label:"Banco"},{key:"activo",label:"Estado",getValue:r=>r.activo?"Activo":"Inactivo"}],"proveedores")},D=i.useMemo(()=>[{key:"rfc",label:"RFC",width:"140px"},{key:"razon_social",label:"Razon Social"},{key:"nombre_comercial",label:"Nombre Comercial",width:"180px"},{key:"telefono",label:"Telefono",width:"130px"},{key:"email",label:"Email",width:"180px"},{key:"giro",label:"Giro",width:"140px"},{key:"activo",label:"Estado",width:"100px",render:e=>a.jsx(X,{variant:e?"success":"default",children:e?"Activo":"Inactivo"})},{key:"id",label:"Acciones",width:"140px",sortable:!1,render:(e,r)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:c=>{c.stopPropagation(),j(r)},className:"text-xs text-primary hover:text-primary-light transition-colors cursor-pointer",children:"Editar"}),a.jsx("button",{onClick:c=>{c.stopPropagation(),A(r)},className:"text-xs text-danger hover:text-danger/80 transition-colors cursor-pointer",children:"Eliminar"})]})}],[]),C=g.isPending||h.isPending;return a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Proveedores"}),a.jsx("p",{className:"text-sm text-text-muted mt-1",children:"Padron de proveedores del ente publico"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-sm font-semibold text-text-secondary",children:["Proveedores",a.jsxs("span",{className:"ml-2 text-text-muted font-normal",children:["(",x.length," registros)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(m,{onClick:R,variant:"outline-primary",size:"sm",children:"Exportar Excel"}),a.jsx(m,{onClick:S,size:"sm",children:"+ Nuevo Proveedor"})]})]}),_?a.jsx("div",{className:"flex items-center justify-center py-16 text-text-muted text-sm",children:"Cargando proveedores..."}):a.jsx(O,{columns:D,data:x,onRowClick:j}),a.jsx(q,{open:N,onClose:()=>s(!1),title:n?"Editar Proveedor":"Nuevo Proveedor",size:"lg",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(t,{label:"RFC",value:o.rfc,onChange:e=>l("rfc",e.target.value),placeholder:"Ej. XAXX010101000",required:!0}),a.jsx(t,{label:"Razon Social",value:o.razon_social,onChange:e=>l("razon_social",e.target.value),placeholder:"Razon social del proveedor",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(t,{label:"Nombre Comercial",value:o.nombre_comercial,onChange:e=>l("nombre_comercial",e.target.value),placeholder:"Nombre comercial"}),a.jsx(t,{label:"Giro",value:o.giro,onChange:e=>l("giro",e.target.value),placeholder:"Giro o actividad"})]}),a.jsx(t,{label:"Domicilio",value:o.domicilio,onChange:e=>l("domicilio",e.target.value),placeholder:"Direccion completa"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(t,{label:"Telefono",value:o.telefono,onChange:e=>l("telefono",e.target.value),placeholder:"Ej. 55 1234 5678"}),a.jsx(t,{label:"Email",type:"email",value:o.email,onChange:e=>l("email",e.target.value),placeholder:"correo@ejemplo.com"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(t,{label:"Contacto",value:o.contacto,onChange:e=>l("contacto",e.target.value),placeholder:"Nombre de la persona de contacto"}),a.jsx(L,{label:"Estado",value:String(o.activo),onChange:e=>l("activo",e.target.value),options:z,placeholder:"-- Seleccione estado --",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(t,{label:"Cuenta Bancaria",value:o.cuenta_bancaria,onChange:e=>l("cuenta_bancaria",e.target.value),placeholder:"Numero de cuenta"}),a.jsx(t,{label:"CLABE Interbancaria",value:o.clabe,onChange:e=>l("clabe",e.target.value),placeholder:"18 digitos"})]}),a.jsx(t,{label:"Banco",value:o.banco,onChange:e=>l("banco",e.target.value),placeholder:"Nombre del banco"}),a.jsxs("div",{className:"flex justify-end gap-3 pt-2 border-t border-border",children:[a.jsx(m,{variant:"ghost",onClick:()=>s(!1),disabled:C,children:"Cancelar"}),a.jsx(m,{onClick:P,loading:C,disabled:!o.rfc.trim()||!o.razon_social.trim(),children:n?"Guardar cambios":"Crear proveedor"})]})]})}),a.jsx(U,{open:E,onClose:()=>{p(!1),v(null)},onConfirm:B,title:"Eliminar proveedor",message:d?`Â¿Esta seguro de eliminar al proveedor "${d.razon_social}"? Esta accion no se puede deshacer.`:"",confirmText:"Eliminar",loading:f.isPending})]})}export{re as default};
