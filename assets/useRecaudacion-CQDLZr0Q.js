import{s as i,u as c,o as a}from"./index-xuYioy8Y.js";async function b(e){const{data:o,error:n}=await i.from("contribuyente").select("*").eq("ente_id",e).order("nombre");if(n)throw n;return o}async function l(e,o){const{data:n,error:t}=await i.from("padron_fiscal").select("*, contribuyente:contribuyente!contribuyente_id(nombre, rfc)").eq("ente_id",e).eq("ejercicio_id",o).order("clave_catastral");if(t)throw t;return n}async function f(e,o){const{data:n,error:t}=await i.from("cobro").select("*, contribuyente:contribuyente!contribuyente_id(nombre, rfc)").eq("ente_id",e).eq("ejercicio_id",o).order("fecha",{ascending:!1});if(t)throw t;return n}async function y(e,o){const[n,t,s]=await Promise.all([i.from("contribuyente").select("id",{count:"exact"}).eq("ente_id",e),i.from("padron_fiscal").select("id",{count:"exact"}).eq("ente_id",e).eq("ejercicio_id",o),i.from("cobro").select("id, monto, estado").eq("ente_id",e).eq("ejercicio_id",o)]),d=s.data||[];return{totalContribuyentes:n.count||0,totalPadron:t.count||0,totalCobros:d.length,montoRecaudado:d.filter(r=>r.estado==="aplicado").reduce((r,u)=>r+Number(u.monto||0),0),montoPendiente:d.filter(r=>r.estado==="pendiente").reduce((r,u)=>r+Number(u.monto||0),0)}}function q(){const{entePublico:e}=c();return a({queryKey:["contribuyentes",e?.id],queryFn:()=>b(e.id),enabled:!!e?.id})}function _(){const{entePublico:e,ejercicioFiscal:o}=c();return a({queryKey:["padron_fiscal",e?.id,o?.id],queryFn:()=>l(e.id,o.id),enabled:!!e?.id&&!!o?.id})}function p(){const{entePublico:e,ejercicioFiscal:o}=c();return a({queryKey:["cobros",e?.id,o?.id],queryFn:()=>f(e.id,o.id),enabled:!!e?.id&&!!o?.id})}function h(){const{entePublico:e,ejercicioFiscal:o}=c();return a({queryKey:["resumen_recaudacion",e?.id,o?.id],queryFn:()=>y(e.id,o.id),enabled:!!e?.id&&!!o?.id})}export{q as a,_ as b,p as c,h as u};
