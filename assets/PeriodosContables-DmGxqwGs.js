import{u as m,j as e}from"./index-Cd8XIyZm.js";import{u as x,b as p,B as b}from"./Button-BNeHdZ8F.js";import{D as h}from"./DataTable-BqJ8iuZr.js";import{B as f}from"./Badge-CAgi_6r3.js";import"./vendor-DEA9Ikep.js";import"./export-t5FFX7R_.js";import"./supabase-DANKYb0E.js";const j={abierto:"success",cerrado:"danger"},u={abierto:"Abierto",cerrado:"Cerrado"};function w(){const{ejercicioFiscal:o,entePublico:n}=m(),{data:a=[],isLoading:c}=x("periodo_contable",{filter:{ejercicio_id:o?.id},order:{column:"numero",ascending:!0}}),t=p("periodo_contable"),l=async s=>{const r=s.estado==="abierto"?"cerrado":"abierto";try{await t.mutateAsync({id:s.id,estado:r})}catch(i){console.error("Error al actualizar periodo contable:",i)}},d=[{key:"numero",label:"No.",width:"70px",render:s=>e.jsx("span",{className:"font-mono text-text-secondary",children:s})},{key:"nombre",label:"Nombre"},{key:"fecha_inicio",label:"Fecha Inicio"},{key:"fecha_fin",label:"Fecha Fin"},{key:"estado",label:"Estado",render:(s,r)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{variant:j[s]||"default",children:u[s]||s}),e.jsx(b,{size:"sm",variant:s==="abierto"?"danger":"primary",onClick:i=>{i.stopPropagation(),l(r)},loading:t.isPending&&t.variables?.id===r.id,disabled:t.isPending,children:s==="abierto"?"Cerrar":"Abrir"})]})}];return o?.id?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Periodos Contables"}),e.jsxs("p",{className:"text-sm text-text-muted mt-1",children:["Periodos del ejercicio fiscal ",o?.anio,n?.nombre?` â€” ${n.nombre}`:""]})]}),e.jsx("div",{className:"mb-4 p-3 rounded-lg border border-info/30 bg-info/5 text-info text-sm",children:"Los periodos contables se generan automaticamente al crear un ejercicio fiscal. Utilice los botones para abrir o cerrar cada periodo segun sea necesario."}),e.jsx("div",{className:"bg-white rounded-lg card-shadow p-4",children:c?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsxs("svg",{className:"animate-spin h-6 w-6 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-3 text-text-muted text-sm",children:"Cargando periodos..."})]}):e.jsx(h,{columns:d,data:a,searchable:!1})}),!c&&a.length>0&&e.jsxs("div",{className:"mt-4 flex items-center gap-6 text-sm text-text-secondary",children:[e.jsxs("span",{children:["Total de periodos: ",e.jsx("span",{className:"font-semibold text-text-primary",children:a.length})]}),e.jsxs("span",{children:["Abiertos:"," ",e.jsx("span",{className:"font-semibold text-success",children:a.filter(s=>s.estado==="abierto").length})]}),e.jsxs("span",{children:["Cerrados:"," ",e.jsx("span",{className:"font-semibold text-danger",children:a.filter(s=>s.estado==="cerrado").length})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-text-muted text-sm",children:"Seleccione un ejercicio fiscal para ver los periodos contables."})})}export{w as default};
